
<!DOCTYPE html>

<html data-content_root="../../" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>AMD Instinct MI100 system optimization — ROCm Documentation</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../_static/pygments.css?v=a746c00c" rel="stylesheet" type="text/css"/>
<link href="../../_static/styles/sphinx-book-theme.css?v=a3416100" rel="stylesheet" type="text/css"/>
<link href="../../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../../_static/custom.css?v=da61d430" rel="stylesheet" type="text/css"/>
<link href="../../_static/rocm_header.css?v=4044f309" rel="stylesheet" type="text/css"/>
<link href="../../_static/rocm_footer.css?v=25204c5a" rel="stylesheet" type="text/css"/>
<link href="../../_static/fonts.css?v=fcff5274" rel="stylesheet" type="text/css"/>
<link href="../../_static/sphinx-design.min.css?v=87e54e7c" rel="stylesheet" type="text/css"/>
<link href="../../_static/rocm_custom.css?v=ace7df76" rel="stylesheet" type="text/css"/>
<link href="../../_static/rocm_rn.css?v=0e8af9ba" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<link as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" rel="preload"/>
<script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/documentation_options.js?v=bc0531d1"></script>
<script src="../../_static/doctools.js?v=9a2dae69"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../../_static/copybutton.js?v=f281be69"></script>
<script async="async" src="../../_static/code_word_breaks.js?v=327952c4"></script>
<script async="async" src="../../_static/renameVersionLinks.js?v=929fe5e4"></script>
<script async="async" src="../../_static/rdcMisc.js?v=01f88d96"></script>
<script async="async" src="../../_static/theme_mode_captions.js?v=15f4ec5d"></script>
<script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
<script src="../../_static/design-tabs.js?v=f930bc37"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'how-to/system-optimization/mi100';</script>
<script async="async" src="https://download.amd.com/js/analytics/analyticsinit.js"></script>
<link href="rocm-stg.amd.com/how-to/system-optimization/mi100.html" rel="canonical"/>
<link href="https://www.amd.com/content/dam/code/images/favicon/favicon.ico" rel="icon"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="w6000-v620.html" rel="next" title="AMD RDNA2 system optimization"/>
<link href="mi200.html" rel="prev" title="AMD Instinct MI200 system optimization"/>
<meta content="vo35SZt_GASsTHAEmdww7AYKPCvZyzLvOXBl8guBME4" name="google-site-verification"/>
</head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<input class="sidebar-toggle" id="pst-primary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
<input class="sidebar-toggle" id="pst-secondary-sidebar-checkbox" type="checkbox"/>
<label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<aside aria-label="Announcement" class="bd-header-announcement">
<div class="bd-header-announcement__content">This page contains proposed changes for a future release of ROCm. Read the <a href="https://rocm.docs.amd.com/en/latest/" id="rocm-banner">latest Linux release of ROCm documentation</a> for your production environments.</div>
</aside>
<header class="common-header">
<nav class="navbar navbar-expand-xl">
<div class="container-fluid main-nav rocm-header">
<button aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler collapsed" data-bs-target="#navbarSupportedContent" data-bs-toggle="collapse" data-tracking-information="mainMenuToggle" id="nav-icon" type="button">
<span></span>
<span></span>
<span></span>
</button>
<div class="header-logo">
<a class="navbar-brand" href="https://www.amd.com/">
<img alt="AMD Logo" class="d-inline-block align-text-top hover-opacity" src="../../_static/images/amd-header-logo.svg" title="AMD Logo" width="90"/>
</a>
<div class="vr vr mx-40 my-25"></div>
<a class="klavika-font hover-opacity" href="https://rocm.docs.amd.com/en/develop">ROCm™ Software Future Release</a>
<a class="header-all-versions" href="https://rocm.docs.amd.com/en/latest/release/versions.html">Version List</a>
</div>
<div class="icon-nav text-center d-flex ms-auto">
</div>
</div>
</nav>
<nav class="navbar navbar-expand-xl second-level-nav">
<div class="container-fluid main-nav">
<div class="navbar-nav-container collapse navbar-collapse" id="navbarSupportedContent">
<ul class="navbar-nav nav-mega me-auto mb-2 mb-lg-0 col-xl-10">
<li class="nav-item">
<a aria-expanded="false" class="nav-link top-level header-menu-links" href="https://github.com/ROCm/ROCm" id="navgithub" role="button" target="_blank">
                                GitHub
                            </a>
</li>
<li class="nav-item">
<a aria-expanded="false" class="nav-link top-level header-menu-links" href="https://github.com/ROCm/ROCm/discussions" id="navcommunity" role="button" target="_blank">
                                Community
                            </a>
</li>
<li class="nav-item">
<a aria-expanded="false" class="nav-link top-level header-menu-links" href="https://rocm.blogs.amd.com/" id="navblogs" role="button" target="_blank">
                                Blogs
                            </a>
</li>
<li class="nav-item">
<a aria-expanded="false" class="nav-link top-level header-menu-links" href="https://www.amd.com/en/developer/resources/infinity-hub.html" id="navinfinity-hub" role="button" target="_blank">
                                Infinity Hub
                            </a>
</li>
<li class="nav-item">
<a aria-expanded="false" class="nav-link top-level header-menu-links" href="https://github.com/ROCm/ROCm/issues/new/choose" id="navsupport" role="button" target="_blank">
                                Support
                            </a>
</li>
</ul>
</div>
</div>
</nav>
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="../../index.html">
<p class="title logo__title">ROCm Documentation</p>
</a></div>
<div class="sidebar-primary-item">
<script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../what-is-rocm.html">What is ROCm?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/release-notes.html">Release notes</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Install</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/">ROCm on Linux</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-windows/en/develop/">HIP SDK on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deep-learning-rocm.html">Deep learning frameworks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build-rocm.html">Build ROCm from source</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How to</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../rocm-for-ai/index.html">Using ROCm for AI</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../rocm-for-ai/install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rocm-for-ai/train-a-model.html">Training a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rocm-for-ai/hugging-face-models.html">Running models from Hugging Face</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rocm-for-ai/deploy-your-model.html">Deploying your model</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../rocm-for-hpc/index.html">Using ROCm for HPC</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../llm-fine-tuning-optimization/index.html">Fine-tuning LLMs and inference optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/overview.html">Conceptual overview</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../llm-fine-tuning-optimization/fine-tuning-and-inference.html">Fine-tuning and inference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../llm-fine-tuning-optimization/single-gpu-fine-tuning-and-inference.html">Using a single accelerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../llm-fine-tuning-optimization/multi-gpu-fine-tuning-and-inference.html">Using multiple accelerators</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/model-quantization.html">Model quantization techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/model-acceleration-libraries.html">Model acceleration libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/llm-inference-frameworks.html">LLM inference frameworks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/optimizing-with-composable-kernel.html">Optimizing with Composable Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/optimizing-triton-kernel.html">Optimizing Triton kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../llm-fine-tuning-optimization/profiling-and-debugging.html">Profiling and debugging</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">System optimization</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mi300x.html">AMD Instinct MI300X</a></li>
<li class="toctree-l2"><a class="reference internal" href="mi300a.html">AMD Instinct MI300A</a></li>
<li class="toctree-l2"><a class="reference internal" href="mi200.html">AMD Instinct MI200</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">AMD Instinct MI100</a></li>
<li class="toctree-l2"><a class="reference internal" href="w6000-v620.html">AMD RDNA 2</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tuning-guides/mi300x/index.html">AMD MI300X performance validation and tuning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../performance-validation/mi300x/vllm-benchmark.html">Performance validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tuning-guides/mi300x/system.html">System tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tuning-guides/mi300x/workload.html">Workload tuning</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/gpu-cluster-networking/en/develop/index.html">GPU cluster networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-enabled-mpi.html">Using MPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system-debugging.html">System debugging</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../conceptual/compiler-topics.html">Using advanced compiler features</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference external" href="https://rocm.docs.amd.com/projects/llvm-project/en/latest/index.html">ROCm compiler infrastructure</a></li>
<li class="toctree-l2"><a class="reference external" href="https://rocm.docs.amd.com/projects/llvm-project/en/latest/conceptual/using-gpu-sanitizer.html">Using AddressSanitizer</a></li>
<li class="toctree-l2"><a class="reference external" href="https://rocm.docs.amd.com/projects/llvm-project/en/latest/conceptual/openmp.html">OpenMP support</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../setting-cus.html">Setting the number of CUs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/amd/rocm-examples">ROCm examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Compatibility</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../compatibility/compatibility-matrix.html">Compatibility matrix</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/reference/system-requirements.html">Linux system requirements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-windows/en/develop/reference/system-requirements.html">Windows system requirements</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/reference/3rd-party-support-matrix.html">Third-party support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/latest/reference/user-kernel-space-compat-matrix.html">User and kernel-space support matrix</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/latest/reference/docker-image-support-matrix.html">Docker image support matrix</a></li>
<li class="toctree-l1"><a class="reference external" href="https://rocm.docs.amd.com/projects/radeon/en/latest/index.html">Use ROCm on Radeon GPUs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Conceptual</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../conceptual/gpu-arch.html">GPU architecture overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../conceptual/gpu-arch/mi300.html">MI300 microarchitecture</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/content/dam/amd/en/documents/instinct-tech-docs/instruction-set-architectures/amd-instinct-mi300-cdna3-instruction-set-architecture.pdf">AMD Instinct MI300/CDNA3 ISA</a></li>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/content/dam/amd/en/documents/instinct-tech-docs/white-papers/amd-cdna-3-white-paper.pdf">White paper</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../conceptual/gpu-arch/mi300-mi200-performance-counters.html">MI300 and MI200 Performance counter</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../conceptual/gpu-arch/mi250.html">MI250 microarchitecture</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/system/files/TechDocs/instinct-mi200-cdna2-instruction-set-architecture.pdf">AMD Instinct MI200/CDNA2 ISA</a></li>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/system/files/documents/amd-cdna2-white-paper.pdf">White paper</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../conceptual/gpu-arch/mi100.html">MI100 microarchitecture</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/system/files/TechDocs/instinct-mi100-cdna1-shader-instruction-set-architecture%C2%A0.pdf">AMD Instinct MI100/CDNA1 ISA</a></li>
<li class="toctree-l3"><a class="reference external" href="https://www.amd.com/system/files/documents/amd-cdna-whitepaper.pdf">White paper</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/gpu-memory.html">GPU memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/file-reorg.html">File structure (Linux FHS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/gpu-isolation.html">GPU isolation techniques</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/cmake-packages.html">Using CMake</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/More-about-how-ROCm-uses-PCIe-Atomics.html">ROCm &amp; PCIe atomics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/ai-pytorch-inception.html">Inception v3 with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conceptual/oversubscription.html">Oversubscription of hardware resources</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../reference/api-libraries.html">ROCm libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/rocm-tools.html">ROCm tools, compilers, and runtimes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/gpu-arch-specs.html">Accelerator and GPU hardware specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/precision-support.html">Precision support</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contribute</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contribute/contributing.html">Contributing to the ROCm docmentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/toolchain.html">ROCm documentation toolchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/building.html">Building documentation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/feedback.html">Providing feedback about the ROCm documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about/license.html">ROCm licenses</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-angle-right"></span>
</label></div>
<div class="header-article-item">
<nav aria-label="Breadcrumb" class="d-print-none">
<ul class="bd-breadcrumbs">
<li class="breadcrumb-item breadcrumb-home">
<a aria-label="Home" class="nav-link" href="../../index.html">
<i class="fa-solid fa-home"></i>
</a>
</li>
<li class="breadcrumb-item"><a class="nav-link" href="index.html">System optimization</a></li>
<li aria-current="page" class="breadcrumb-item active">AMD...</li>
</ul>
</nav>
</div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</button>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>AMD Instinct MI100 system optimization</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-settings">System settings</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#system-bios-settings">System BIOS settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nbio-link-clock-frequency">NBIO link clock frequency</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-configuration">Memory configuration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operating-system-settings">Operating system settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-core-states-c-states">CPU core states - C-states</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-iopm-util">AMD-IOPM-UTIL</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#systems-with-256-cpu-threads-iommu-configuration">Systems with 256 CPU threads - IOMMU configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-management">System management</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware-verification-with-rocm">Hardware verification with ROCm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-inter-device-bandwidth">Testing inter-device bandwidth</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<head>
<meta charset="utf-8"/>
<meta content="MI100 high-performance computing and tuning guide" name="description"/>
<meta content="MI100, high-performance computing, HPC, BIOS
  settings, NBIO, AMD, ROCm" name="keywords"/>
</head>
<section class="tex2jax_ignore mathjax_ignore" id="amd-instinct-mi100-system-optimization">
<h1>AMD Instinct MI100 system optimization<a class="headerlink" href="#amd-instinct-mi100-system-optimization" title="Link to this heading">#</a></h1><div class="sd-container-fluid sd-sphinx-override sd-p-0 sd-mt-2 sd-mb-4 sd-p-2 sd-rounded-1 docutils" id="rocm-docs-core-article-info">
<div class="sd-row sd-row-cols-2 sd-gx-2 sd-gy-1 docutils">
<div class="sd-col sd-col-auto sd-d-flex-row sd-align-minor-center docutils" style="color:gray;">
    Applies to Linux
</div>
<div class="sd-col sd-d-flex-row sd-align-minor-center docutils">
<div class="sd-container-fluid sd-sphinx-override docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-3 sd-row-cols-md-3 sd-row-cols-lg-3 sd-gx-3 sd-gy-1 docutils">
<div class="sd-col sd-col-auto sd-d-flex-row sd-align-minor-center docutils">
<p class="sd-p-0 sd-m-0" style="color:gray;"></p>
</div>
<div class="sd-col sd-col-auto sd-d-flex-row sd-align-minor-center docutils">
<p class="sd-p-0 sd-m-0" style="color:gray;"><span class="sd-pr-2"><svg aria-hidden="true" class="sd-octicon sd-octicon-calendar" height="16.0px" version="1.1" viewbox="0 0 16 16" width="16.0px"><path d="M4.75 0a.75.75 0 01.75.75V2h5V.75a.75.75 0 011.5 0V2h1.25c.966 0 1.75.784 1.75 1.75v10.5A1.75 1.75 0 0113.25 16H2.75A1.75 1.75 0 011 14.25V3.75C1 2.784 1.784 2 2.75 2H4V.75A.75.75 0 014.75 0zm0 3.5h8.5a.25.25 0 01.25.25V6h-11V3.75a.25.25 0 01.25-.25h2zm-2.25 4v6.75c0 .138.112.25.25.25h10.5a.25.25 0 00.25-.25V7.5h-11z" fill-rule="evenodd"></path></svg></span>2024-10-18</p>
</div>
<div class="sd-col sd-col-auto sd-d-flex-row sd-align-minor-center docutils">
<p class="sd-p-0 sd-m-0" style="color:gray;"><span class="sd-pr-2"><svg aria-hidden="true" class="sd-octicon sd-octicon-clock" height="16.0px" version="1.1" viewbox="0 0 16 16" width="16.0px"><path d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM8 0a8 8 0 100 16A8 8 0 008 0zm.5 4.75a.75.75 0 00-1.5 0v3.5a.75.75 0 00.471.696l2.5 1a.75.75 0 00.557-1.392L8.5 7.742V4.75z" fill-rule="evenodd"></path></svg></span>16 min read time</p>
</div>
</div>
</div>
</div>
</div>
</div>

<section id="system-settings">
<h2>System settings<a class="headerlink" href="#system-settings" title="Link to this heading">#</a></h2>
<p>This chapter reviews system settings that are required to configure the system
for AMD Instinct™ MI100 accelerators and that can improve performance of the
GPUs. It is advised to configure the system for best possible host configuration
according to the high-performance computing tuning guides for AMD EPYC™
7002 Series and EPYC™ 7003 Series processors, depending on the processor generation of the
system.</p>
<p>In addition to the BIOS settings listed below the following settings
(<a class="reference internal" href="#mi100-bios-settings"><span class="std std-ref">System BIOS settings</span></a>) will also have to be enacted via the command line (see
<a class="reference internal" href="#mi100-os-settings"><span class="std std-ref">Operating system settings</span></a>):</p>
<ul class="simple">
<li><p>Core C states</p></li>
<li><p>AMD-PCI-UTIL (on AMD EPYC™ 7002 series processors)</p></li>
<li><p>IOMMU (if needed)</p></li>
</ul>
<section id="system-bios-settings">
<span id="mi100-bios-settings"></span><h3>System BIOS settings<a class="headerlink" href="#system-bios-settings" title="Link to this heading">#</a></h3>
<p>For maximum MI100 GPU performance on systems with AMD EPYC™ 7002 series
processors (codename “Rome”) and AMI System BIOS, the following configuration of
System BIOS settings has been validated. These settings must be used for the
qualification process and should be set as default values for the system BIOS.
Analogous settings for other non-AMI System BIOS providers could be set
similarly. For systems with Intel processors, some settings may not apply or be
available as listed in the following table.</p>
<div class="pst-scrollable-table-container"><table class="table" id="mi100-bios">
<caption><span class="caption-text">Recommended settings for the system BIOS in a GIGABYTE platform.</span><a class="headerlink" href="#mi100-bios" title="Link to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>BIOS Setting Location</p></th>
<th class="head"><p>Parameter</p></th>
<th class="head"><p>Value</p></th>
<th class="head"><p>Comments</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Advanced / PCI Subsystem Settings</p></td>
<td><p>Above 4G Decoding</p></td>
<td><p>Enabled</p></td>
<td><p>GPU Large BAR Support</p></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / CPU Common Options</p></td>
<td><p>Global C-state Control</p></td>
<td><p>Auto</p></td>
<td><p>Global C-States</p></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / CPU Common Options</p></td>
<td><p>CCD/Core/Thread Enablement</p></td>
<td><p>Accept</p></td>
<td><p>Global C-States</p></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / CPU Common Options / Performance</p></td>
<td><p>SMT Control</p></td>
<td><p>Disable</p></td>
<td><p>Global C-States</p></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / DF Common Options / Memory Addressing</p></td>
<td><p>NUMA nodes per socket</p></td>
<td><p>NPS 1,2,4</p></td>
<td><p>NUMA Nodes (NPS)</p></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / DF Common Options / Memory Addressing</p></td>
<td><p>Memory interleaving</p></td>
<td><p>Auto</p></td>
<td><p>Numa Nodes (NPS)</p></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / DF Common Options / Link</p></td>
<td><p>4-link xGMI max speed</p></td>
<td><p>18 Gbps</p></td>
<td><p>Set AMD CPU xGMI speed to highest rate supported</p></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / DF Common Options / Link</p></td>
<td><p>3-link xGMI max speed</p></td>
<td><p>18 Gbps</p></td>
<td><p>Set AMD CPU xGMI speed to highest rate supported</p></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options</p></td>
<td><p>IOMMU</p></td>
<td><p>Disable</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options</p></td>
<td><p>PCIe Ten Bit Tag Support</p></td>
<td><p>Enable</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options</p></td>
<td><p>Preferred IO</p></td>
<td><p>Manual</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options</p></td>
<td><p>Preferred IO Bus</p></td>
<td><p>“Use lspci to find pci device id”</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options</p></td>
<td><p>Enhanced Preferred IO Mode</p></td>
<td><p>Enable</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>Determinism Control</p></td>
<td><p>Manual</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>Determinism Slider</p></td>
<td><p>Power</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>cTDP Control</p></td>
<td><p>Manual</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>cTDP</p></td>
<td><p>240</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>Package Power Limit Control</p></td>
<td><p>Manual</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>Package Power Limit</p></td>
<td><p>240</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>xGMI Link Width Control</p></td>
<td><p>Manual</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>xGMI Force Link Width</p></td>
<td><p>2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>xGMI Force Link Width Control</p></td>
<td><p>Force</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>APBDIS</p></td>
<td><p>1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>DF C-states</p></td>
<td><p>Auto</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / NBIO Common Options / SMU Common Options</p></td>
<td><p>Fixed SOC P-state</p></td>
<td><p>P0</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / UMC Common Options / DDR4 Common Options</p></td>
<td><p>Enforce POR</p></td>
<td><p>Accept</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / UMC Common Options / DDR4 Common Options / Enforce POR</p></td>
<td><p>Overclock</p></td>
<td><p>Enabled</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / UMC Common Options / DDR4 Common Options / Enforce POR</p></td>
<td><p>Memory Clock Speed</p></td>
<td><p>1600 MHz</p></td>
<td><p>Set to max Memory Speed, if using 3200 MHz DIMMs</p></td>
</tr>
<tr class="row-even"><td><p>AMD CBS / UMC Common Options / DDR4 Common Options / DRAM Controller
Configuration / DRAM Power Options</p></td>
<td><p>Power Down Enable</p></td>
<td><p>Disabled</p></td>
<td><p>RAM Power Down</p></td>
</tr>
<tr class="row-odd"><td><p>AMD CBS / Security</p></td>
<td><p>TSME</p></td>
<td><p>Disabled</p></td>
<td><p>Memory Encryption</p></td>
</tr>
</tbody>
</table>
</div>
<section id="nbio-link-clock-frequency">
<h4>NBIO link clock frequency<a class="headerlink" href="#nbio-link-clock-frequency" title="Link to this heading">#</a></h4>
<p>The NBIOs (4x per AMD EPYC™ processor) are the serializers/deserializers (also
known as “SerDes”) that convert and prepare the I/O signals for the processor’s
128 external I/O interface lanes (32 per NBIO).</p>
<p>LCLK (short for link clock frequency) controls the link speed of the internal
bus that connects the NBIO silicon with the data fabric. All data between the
processor and its PCIe lanes flow to the data fabric based on these LCLK
frequency settings. The link clock frequency of the NBIO components need to be
forced to the maximum frequency for optimal PCIe performance.</p>
<p>For AMD EPYC™ 7002 series processors, this setting cannot be modified via
configuration options in the server BIOS alone. Instead, the AMD-IOPM-UTIL (see
Section 3.2.3) must be run at every server boot to disable Dynamic Power
Management for all PCIe Root Complexes and NBIOs within the system and to lock
the logic into the highest performance operational mode.</p>
<p>For AMD EPYC™ 7003 series processors, configuring all NBIOs to be in “Enhanced
Preferred I/O” mode is sufficient to enable highest link clock frequency for the
NBIO components.</p>
</section>
<section id="memory-configuration">
<h4>Memory configuration<a class="headerlink" href="#memory-configuration" title="Link to this heading">#</a></h4>
<p>For the memory addressing modes, especially the
number of NUMA nodes per socket/processor (NPS), the recommended setting is
to follow the guidance of the high-performance computing tuning guides
for AMD EPYC™ 7002 Series and AMD EPYC™ 7003 Series processors to provide the optimal
configuration for host side computation.</p>
<p>If the system is set to one NUMA domain per socket/processor (NPS1),
bidirectional copy bandwidth between host memory and GPU memory may be
slightly higher (up to about 16% more) than with four NUMA domains per socket
processor (NPS4). For memory bandwidth sensitive applications using MPI, NPS4
is recommended. For applications that are not optimized for NUMA locality,
NPS1 is the recommended setting.</p>
</section>
</section>
<section id="operating-system-settings">
<span id="mi100-os-settings"></span><h3>Operating system settings<a class="headerlink" href="#operating-system-settings" title="Link to this heading">#</a></h3>
<section id="cpu-core-states-c-states">
<h4>CPU core states - C-states<a class="headerlink" href="#cpu-core-states-c-states" title="Link to this heading">#</a></h4>
<p>There are several core states (C-states) that an AMD EPYC CPU can idle within:</p>
<ul class="simple">
<li><p>C0: active. This is the active state while running an application.</p></li>
<li><p>C1: idle</p></li>
<li><p>C2: idle and power gated. This is a deeper sleep state and will have a
greater latency when moving back to the C0 state, compared to when the
CPU is coming out of C1.</p></li>
</ul>
<p>Disabling C2 is important for running with a high performance, low-latency
network. To disable power-gating on all cores run the following on Linux
systems:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>cpupower<span class="w"> </span>idle-set<span class="w"> </span>-d<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">cpupower</span></code> tool must be installed, as it is not part of the base
packages of most Linux® distributions. The package needed varies with the
respective Linux distribution.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ubuntu" for="sd-tab-item-0">
Ubuntu</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>linux-tools-common
</pre></div>
</div>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="RHEL" for="sd-tab-item-1">
Red Hat Enterprise Linux</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>cpupowerutils
</pre></div>
</div>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="SLES" for="sd-tab-item-2">
SUSE Linux Enterprise Server</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>zypper<span class="w"> </span>install<span class="w"> </span>cpupower
</pre></div>
</div>
</div>
</div>
</section>
<section id="amd-iopm-util">
<h4>AMD-IOPM-UTIL<a class="headerlink" href="#amd-iopm-util" title="Link to this heading">#</a></h4>
<p>This section applies to AMD EPYC™ 7002 processors to optimize advanced
Dynamic Power Management (DPM) in the I/O logic (see NBIO description above)
for performance. Certain I/O workloads may benefit from disabling this power
management. This utility disables DPM for all PCI-e root complexes in the
system and locks the logic into the highest performance operational mode.</p>
<p>Disabling I/O DPM will reduce the latency and/or improve the throughput of
low-bandwidth messages for PCI-e InfiniBand NICs and GPUs. Other workloads
with low-bandwidth bursty PCI-e I/O characteristics may benefit as well if
multiple such PCI-e devices are installed in the system.</p>
<p>The actions of the utility do not persist across reboots. There is no need to
change any existing firmware settings when using this utility. The “Preferred
I/O” and “Enhanced Preferred I/O” settings should remain unchanged at enabled.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The recommended method to use the utility is either to create a system
start-up script, for example, a one-shot <code class="docutils literal notranslate"><span class="pre">systemd</span></code> service unit, or run the
utility when starting up a job scheduler on the system. The installer
packages (see
<a class="reference external" href="https://developer.amd.com/iopm-utility/">Power Management Utility</a>) will
create and enable a <code class="docutils literal notranslate"><span class="pre">systemd</span></code> service unit for you. This service unit is
configured to run in one-shot mode. This means that even when the service
unit runs as expected, the status of the service unit will show inactive.
This is the expected behavior when the utility runs normally. If the service
unit shows failed, the utility did not run as expected. The output in either
case can be shown with the <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">status</span></code> command.</p>
<p>Stopping the service unit has no effect since the utility does not leave
anything running. To undo the effects of the utility, disable the service
unit with the <code class="docutils literal notranslate"><span class="pre">systemctl</span> <span class="pre">disable</span></code> command and reboot the system.</p>
<p>The utility does not have any command-line options, and it must be run with
super-user permissions.</p>
</div>
</section>
<section id="systems-with-256-cpu-threads-iommu-configuration">
<h4>Systems with 256 CPU threads - IOMMU configuration<a class="headerlink" href="#systems-with-256-cpu-threads-iommu-configuration" title="Link to this heading">#</a></h4>
<p>For systems that have 256 logical CPU cores or more (e.g., 64-core AMD EPYC™
7763 in a dual-socket configuration and SMT enabled), setting the input-output
memory management unit (IOMMU) configuration to “disabled” can limit the number
of available logical cores to 255. The reason is that the Linux® kernel disables
X2APIC in this case and falls back to Advanced Programmable Interrupt Controller
(APIC), which can only enumerate a maximum of 255 (logical) cores.</p>
<p>If SMT is enabled by setting “CCD/Core/Thread Enablement &gt; SMT Control” to
“enable”, the following steps can be applied to the system to enable all
(logical) cores of the system:</p>
<ul>
<li><p>In the server BIOS, set IOMMU to “Enabled”.</p></li>
<li><p>When configuring the Grub boot loader, add the following argument for the
Linux kernel: <code class="docutils literal notranslate"><span class="pre">iommu=pt</span></code></p></li>
<li><p>Update Grub to use the modified configuration:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>grub2-mkconfig<span class="w"> </span>-o<span class="w"> </span>/boot/grub2/grub.cfg
</pre></div>
</div>
</li>
<li><p>Reboot the system.</p></li>
<li><p>Verify IOMMU passthrough mode by inspecting the kernel log via <code class="docutils literal notranslate"><span class="pre">dmesg</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[...]
[   0.000000] Kernel command line: [...] iommu=pt
   [...]
</pre></div>
</div>
</li>
</ul>
<p>Once the system is properly configured, ROCm software can be
installed.</p>
</section>
</section>
</section>
<section id="system-management">
<h2>System management<a class="headerlink" href="#system-management" title="Link to this heading">#</a></h2>
<p>For a complete guide on how to install/manage/uninstall ROCm on Linux, refer to
<a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/install/quick-start.html" title="(in ROCm installation on Linux v6.2.4)"><span class="xref std std-doc">Quick-start (Linux)</span></a>. To verify that the installation was
successful, refer to the
<a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/install/post-install.html" title="(in ROCm installation on Linux v6.2.4)"><span class="xref std std-doc">post-install instructions</span></a> and
<a class="reference internal" href="../../reference/rocm-tools.html"><span class="std std-doc">system tools</span></a>. Should verification
fail, consult the <a class="reference internal" href="../system-debugging.html"><span class="std std-doc">System Debugging Guide</span></a>.</p>
<section id="hardware-verification-with-rocm">
<span id="mi100-hw-verification"></span><h3>Hardware verification with ROCm<a class="headerlink" href="#hardware-verification-with-rocm" title="Link to this heading">#</a></h3>
<p>The AMD ROCm™ platform ships with tools to query the system structure. To query
the GPU hardware, the <code class="docutils literal notranslate"><span class="pre">rocm-smi</span></code> command is available. It can show available
GPUs in the system with their device ID and their respective firmware (or VBIOS)
versions:</p>
<p><img alt="rocm-smi --showhw output on an 8*MI100 system" src="../../_images/tuning001.png"/></p>
<p>Another important query is to show the system structure, the localization of the
GPUs in the system, and the fabric connections between the system components:</p>
<p><img alt="mi100-smi-showtopo output on an 8*MI100 system" src="../../_images/tuning002.png"/></p>
<p>The previous command shows the system structure in four blocks:</p>
<ul class="simple">
<li><p>The first block of the output shows the distance between the GPUs similar to
what the <code class="docutils literal notranslate"><span class="pre">numactl</span></code> command outputs for the NUMA domains of a system. The
weight is a qualitative measure for the “distance” data must travel to reach
one GPU from another one. While the values do not carry a special (physical)
meaning, the higher the value the more hops are needed to reach the
destination from the source GPU.</p></li>
<li><p>The second block has a matrix for the number of hops required to send data
from one GPU to another. For the GPUs in the local hive, this number is one,
while for the others it is three (one hop to leave the hive, one hop across
the processors, and one hop within the destination hive).</p></li>
<li><p>The third block outputs the link types between the GPUs. This can either be
“XGMI” for AMD Infinity Fabric™ links or “PCIE” for PCIe Gen4 links.</p></li>
<li><p>The fourth block reveals the localization of a GPU with respect to the NUMA
organization of the shared memory of the AMD EPYC™ processors.</p></li>
</ul>
<p>To query the compute capabilities of the GPU devices, the <code class="docutils literal notranslate"><span class="pre">rocminfo</span></code> command is
available with the AMD ROCm™ platform. It lists specific details about the GPU
devices, including but not limited to the number of compute units, width of the
SIMD pipelines, memory information, and Instruction Set Architecture:</p>
<p><img alt="rocminfo output fragment on an 8*MI100 system" src="../../_images/tuning003.png"/></p>
<p>For a complete list of architecture (LLVM target) names, refer to
<a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-linux/en/develop/reference/system-requirements.html" title="(in ROCm installation on Linux v6.2.4)"><span class="xref std std-doc">Linux</span></a> and
<a class="reference external" href="https://rocm.docs.amd.com/projects/install-on-windows/en/develop/reference/system-requirements.html" title="(in HIP SDK installation on Windows v6.0.0)"><span class="xref std std-doc">Windows</span></a> support.</p>
</section>
<section id="testing-inter-device-bandwidth">
<h3>Testing inter-device bandwidth<a class="headerlink" href="#testing-inter-device-bandwidth" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="#mi100-hw-verification"><span class="std std-ref">Hardware verification with ROCm</span></a> showed the <code class="docutils literal notranslate"><span class="pre">rocm-smi</span> <span class="pre">--showtopo</span></code> command to show
how the system structure and how the GPUs are located and connected in this
structure. For more details, the <code class="docutils literal notranslate"><span class="pre">rocm-bandwidth-test</span></code> can run benchmarks to
show the effective link bandwidth between the components of the system.</p>
<p>The ROCm Bandwidth Test program can be installed with the following
package-manager commands:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-1" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="ubuntu" for="sd-tab-item-3">
Ubuntu</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>rocm-bandwidth-test
</pre></div>
</div>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-1" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="RHEL" for="sd-tab-item-4">
Red Hat Enterprise Linux</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>yum<span class="w"> </span>install<span class="w"> </span>rocm-bandwidth-test
</pre></div>
</div>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-1" type="radio"/>
<label class="sd-tab-label" data-sync-group="tab" data-sync-id="SLES" for="sd-tab-item-5">
SUSE Linux Enterprise Server</label><div class="sd-tab-content docutils">
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>zypper<span class="w"> </span>install<span class="w"> </span>rocm-bandwidth-test
</pre></div>
</div>
</div>
</div>
<p>Alternatively, the source code can be downloaded and built from
<a class="reference external" href="https://github.com/ROCm/rocm_bandwidth_test">source</a>.</p>
<p>The output will list the available compute devices (CPUs and GPUs):</p>
<p><img alt="rocm-bandwidth-test output fragment on an 8*MI100 system listing devices" src="../../_images/tuning004.png"/></p>
<p>The output will also show a matrix that contains a “1” if a device can
communicate to another device (CPU and GPU) of the system and it will show the
NUMA distance (similar to <code class="docutils literal notranslate"><span class="pre">rocm-smi</span></code>):</p>
<p><img alt="rocm-bandwidth-test output fragment on an 8*MI100 system showing inter-device access matrix" src="../../_images/tuning005.png"/></p>
<p><img alt="rocm-bandwidth-test output fragment on an 8*MI100 system showing inter-device NUMA distance" src="../../_images/tuning006.png"/></p>
<p>The output also contains the measured bandwidth for unidirectional and
bidirectional transfers between the devices (CPU and GPU):</p>
<p><img alt="rocm-bandwidth-test output fragment on an 8*MI100 system showing uni- and bidirectional bandwidths" src="../../_images/tuning004.png"/></p>
</section>
</section>
</section>
</article>
<footer class="prev-next-footer d-print-none">
<div class="prev-next-area">
<a class="left-prev" href="mi200.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">AMD Instinct MI200 system optimization</p>
</div>
</a>
<a class="right-next" href="w6000-v620.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">AMD RDNA2 system optimization</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-settings">System settings</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#system-bios-settings">System BIOS settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nbio-link-clock-frequency">NBIO link clock frequency</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-configuration">Memory configuration</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operating-system-settings">Operating system settings</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cpu-core-states-c-states">CPU core states - C-states</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#amd-iopm-util">AMD-IOPM-UTIL</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#systems-with-256-cpu-threads-iommu-configuration">Systems with 256 CPU threads - IOMMU configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#system-management">System management</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hardware-verification-with-rocm">Hardware verification with ROCm</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-inter-device-bandwidth">Testing inter-device bandwidth</a></li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<p>
</p>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>
<footer class="rocm-footer">
<div class="container-lg">
<section class="bottom-menu menu py-45">
<div class="row d-flex align-items-center">
<div class="col-12 text-center">
<ul>
<li><a href="https://www.amd.com/en/corporate/copyright" target="_blank">Terms and Conditions</a></li>
<li><a href="https://rocm.docs.amd.com/en/develop/about/license.html">ROCm Licenses and Disclaimers</a></li>
<li><a href="https://www.amd.com/en/corporate/privacy" target="_blank">Privacy</a></li>
<li><a href="https://www.amd.com/en/corporate/trademarks" target="_blank">Trademarks</a></li>
<li><a href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf" target="_blank">Statement on Forced Labor</a></li>
<li><a href="https://www.amd.com/en/corporate/competition" target="_blank">Fair and Open Competition</a></li>
<li><a href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf" target="_blank">UK Tax Strategy</a></li>
<li><a href="https://www.amd.com/en/corporate/cookies" target="_blank">Cookie Policy</a></li>
<!-- OneTrust Cookies Settings button start -->
<li><a class="ot-sdk-show-settings" href="#cookie-settings" id="ot-sdk-btn">Cookie Settings</a></li>
<!-- OneTrust Cookies Settings button end -->
</ul>
</div>
</div>
<div class="row d-flex align-items-center">
<div class="col-12 text-center">
<div>
<span class="copyright">© 2024 Advanced Micro Devices, Inc</span>
</div>
</div>
</div>
</section>
</div>
</footer>
<!-- <div id="rdc-watermark-container">
    <img id="rdc-watermark" src="../../_static/images/alpha-watermark.svg" alt="DRAFT watermark"/>
</div> -->
</body>
</html>